<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of spm_three_states_battery_voltage</title>
  <meta name="keywords" content="spm_three_states_battery_voltage">
  <meta name="description" content="returns v_cell given the vector x and input u at any given time-step">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html src --><!-- menu.html sim_modular_fcns -->
<h1>spm_three_states_battery_voltage
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>returns v_cell given the vector x and input u at any given time-step</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function v_cell = spm_three_states_battery_voltage(x,u,param) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> returns v_cell given the vector x and input u at any given time-step
 x(1) = q_pos, x(2) = q_neg, x(3) = cs_avg_neg
 u = load current (A). Positive implies discharge.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../src/cts_time_spm_simulation.html" class="code" title="">cts_time_spm_simulation</a>	Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu></li><li><a href="../../src/disc_time_spm_simulation.html" class="code" title="">disc_time_spm_simulation</a>	Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu></li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function v_cell = spm_three_states_battery_voltage(x,u,param)</a>
0002 <span class="comment">% returns v_cell given the vector x and input u at any given time-step</span>
0003 <span class="comment">% x(1) = q_pos, x(2) = q_neg, x(3) = cs_avg_neg</span>
0004 <span class="comment">% u = load current (A). Positive implies discharge.</span>
0005 
0006 <span class="comment">% Copyright (c) 2018 Gopalakrishnan, Krishnakumar &lt;krishnak@vt.edu&gt;</span>
0007 <span class="comment">% Author: Gopalakrishnan, Krishnakumar &lt;krishnak@vt.edu&gt;</span>
0008 
0009 R      = param.R;
0010 T      = param.Tref;
0011 F      = param.F;
0012 
0013 R_pos  = param.R_p;
0014 R_neg  = param.R_n;
0015 
0016 Ds_pos = param.D_p;
0017 Ds_neg = param.D_n;
0018 
0019 a_pos  = param.a_p;
0020 a_neg  = param.a_n;
0021 
0022 L_pos  = param.len_p;
0023 L_neg  = param.len_n;
0024 
0025 k_p    = param.k_p;
0026 k_n    = param.k_n;
0027 
0028 ce     = param.ce_init;
0029 A      = param.A;
0030 
0031 cs_max_n = param.cs_max_n;
0032 cs_max_p = param.cs_max_p;
0033 
0034 theta_min_neg = param.theta_min_neg;
0035 theta_min_pos = param.theta_min_pos;
0036 theta_max_neg = param.theta_max_neg;
0037 theta_max_pos = param.theta_max_pos;
0038 
0039 <span class="comment">% Extract permissible bounds for solid concentrations</span>
0040 cs_surf_pos_lb = param.theta_max_pos*param.cs_max_p;
0041 cs_surf_pos_ub = param.theta_min_pos*param.cs_max_p;
0042 cs_surf_neg_lb = param.theta_min_neg*param.cs_max_n;
0043 cs_surf_neg_ub = param.theta_max_neg*param.cs_max_n;
0044 
0045 <span class="comment">% Extract the function handles for Uocp_pos and Uocp_neg</span>
0046 compute_Uocp_pos = param.compute_Uocp_pos;
0047 compute_Uocp_neg = param.compute_Uocp_neg;
0048 
0049 <span class="comment">%% Compute surface concentrations</span>
0050 cs_surf_neg = x(3) + (8*R_neg/35)*x(2) - (R_neg/(35*Ds_neg*a_neg*L_neg*F*A))*u;
0051 cs_surf_neg = min(cs_surf_neg_ub, max(cs_surf_neg_lb, cs_surf_neg)); <span class="comment">% saturation</span>
0052 
0053 cs_avg_pos = cs_max_p*(theta_min_pos + ((x(3) - theta_min_neg*cs_max_n)./((theta_max_neg - theta_min_neg)*cs_max_n))*(theta_max_pos - theta_min_pos));  <span class="comment">% average concentration in pos electrodue (analytical expn using conservation of Li)</span>
0054 cs_surf_pos = cs_avg_pos + (8*R_pos/35)*x(1) + (R_pos/(35*Ds_pos*a_pos*L_pos*F*A))*u; <span class="comment">% surface concentration of pos electrode</span>
0055 cs_surf_pos = min(cs_surf_pos_ub, max(cs_surf_pos_lb, cs_surf_pos)); <span class="comment">% saturation</span>
0056 
0057 <span class="comment">%% Compute overpotentials</span>
0058 eta_p = (2*R*T/F)*asinh(-u/(2*A*F*a_pos*L_pos*k_p*sqrt(ce*cs_surf_pos*(cs_max_p - cs_surf_pos))));
0059 eta_n = (2*R*T/F)*asinh(u/(2*A*F*a_neg*L_neg*k_n*sqrt(ce*cs_surf_neg*(cs_max_n - cs_surf_neg))));
0060 
0061 <span class="comment">%% Compute OCPs</span>
0062 surf_theta_p  = cs_surf_pos/param.cs_max_p;
0063 surf_theta_n  = cs_surf_neg/param.cs_max_n;
0064 
0065 U_p = compute_Uocp_pos(surf_theta_p);
0066 U_n = compute_Uocp_neg(surf_theta_n);
0067 
0068 phi_pos = eta_p + U_p;
0069 phi_neg = eta_n + U_n;
0070 
0071 v_cell = phi_pos - phi_neg;
0072 
0073 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 26-May-2018 17:01:07 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>